{%- comment -%}
  Responsive image include

  Parameters:
  - path: Relative path to source image (e.g., "assets/images/posts/Meenhard/cover.jpg")
  - alt: Alt text for accessibility

  Context is automatically inferred from page.layout (home vs project)
{%- endcomment -%}

{%- assign path_without_ext = include.path | remove: '.jpg' | remove: '.jpeg' | remove: '.png' -%}
{%- assign original_url = include.path | relative_url -%}

{%- if page.layout == 'home' -%}
  {%- comment -%} Home page: thumbnail (1x) and small (2x) for retina {%- endcomment -%}
  {%- assign thumbnail_webp = path_without_ext | append: '-thumbnail.webp' | relative_url -%}
  {%- assign thumbnail_jpg = path_without_ext | append: '-thumbnail.jpg' | relative_url -%}
  {%- assign small_webp = path_without_ext | append: '-small.webp' | relative_url -%}
  {%- assign small_jpg = path_without_ext | append: '-small.jpg' | relative_url -%}

  <picture>
    <source srcset="{{ thumbnail_webp }} 1x, {{ small_webp }} 2x" type="image/webp">
    <source srcset="{{ thumbnail_jpg }} 1x, {{ small_jpg }} 2x" type="image/jpeg">
    <img src="{{ small_jpg }}" alt="{{ include.alt }}" loading="lazy">
  </picture>

{%- else -%}
  {%- comment -%} Project page: medium (1x) and large (2x) for retina {%- endcomment -%}
  {%- assign medium_webp = path_without_ext | append: '-medium.webp' | relative_url -%}
  {%- assign medium_jpg = path_without_ext | append: '-medium.jpg' | relative_url -%}
  {%- assign large_webp = path_without_ext | append: '-large.webp' | relative_url -%}
  {%- assign large_jpg = path_without_ext | append: '-large.jpg' | relative_url -%}

  <a href="{{ original_url }}" target="_blank">
    <picture>
      <source srcset="{{ medium_webp }} 1x, {{ large_webp }} 2x" type="image/webp">
      <source srcset="{{ medium_jpg }} 1x, {{ large_jpg }} 2x" type="image/jpeg">
      <img src="{{ large_jpg }}" alt="{{ include.alt }}" loading="lazy">
    </picture>
  </a>
{%- endif -%}
