<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "de" }}">
  {%- include head.liquid -%}
  <body>
    {%- include header.liquid -%}

    <main class="content">
      <article class="project">
        <header class="project-header">
          <h1>{{ page.title }}</h1>
        </header>
        
        <section class="project-gallery">
          {%- assign cover_path = 'assets/images/posts/' | append: page.title | append: '/cover.jpg' -%}
          {%- assign cover_alt = page.title | append: ' - Cover' -%}
          <figure class="project-image project-cover">
            {%- include responsive_image.liquid
                path=cover_path
                alt=cover_alt
                link_original=true -%}
          </figure>

          {% assign post_images_path = '/assets/images/posts/' | append: page.title | append: '/' %}
          {% assign cover_path_full = '/assets/images/posts/' | append: page.title | append: '/cover.jpg' %}
          {% assign all_images = site.static_files | where_exp: "file", "file.path contains post_images_path" %}
          {% assign filtered_images = "" | split: "" %}
          {% for img in all_images %}
            {% unless img.path contains '-thumbnail.' or img.path contains '-small.' or img.path contains '-medium.' or img.path contains '-large.' %}
              {% unless img.path == cover_path_full %}
                {% assign filtered_images = filtered_images | push: img %}
              {% endunless %}
            {% endunless %}
          {% endfor %}
          {% assign numbered_images = filtered_images | sort: "path" %}
          {% if numbered_images.size > 0 %}
            <section class="project-additional-images">
              <h2 class="visually-hidden">Additional Images</h2>
              {% for image in numbered_images %}
                {% assign image_number = forloop.index %}
                {% assign image_description = page.image_descriptions[image_number] | default: 'Detail view' %}
                <figure class="project-image">
                  {%- assign image_path = image.path | remove_first: '/' -%}
                  {%- assign image_alt = page.title | append: ' - ' | append: image_description | append: ' (Image ' | append: image_number | append: ' of ' | append: numbered_images.size | append: ')' -%}
                  {%- include responsive_image.liquid
                      path=image_path
                      alt=image_alt
                      link_original=true -%}
                  {% if page.image_captions[image_number] %}
                    <figcaption>{{ page.image_captions[image_number] }}</figcaption>
                  {% endif %}
                </figure>
              {% endfor %}
            </section>
          {% endif %}
        </section>
      </article>
    </main>
  </body>
</html>
